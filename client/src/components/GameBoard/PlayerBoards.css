.pb-resize-container {
    display: block;
    width: 100%;
    height: 100%;
    min-width: 0;
    min-height: 0;
    overflow: hidden;
    /* Prevent scrollbars from affecting width */
}

.player-boards-container {
    width: 100%;
    height: 100%;
    /* Font size is set via JS ResizeObserver */
    padding: 1em;
    background-color: #f3f4f6;
    border-radius: 0.5em;
    box-sizing: border-box;
    /* Ensure padding doesn't cause overflow */
}

.player-board-section {
    display: flex;
    flex-direction: column;
    background: white;
    border-radius: 0.5em;
    box-shadow: 0 0.25em 0.375em -0.0625em rgba(0, 0, 0, 0.1), 0 0.125em 0.25em -0.0625em rgba(0, 0, 0, 0.06);
    overflow: hidden;
    margin-bottom: 1em;
    padding: 0.5em;
    gap: 0.5em;
}

/* Header Section */
.pb-header {
    display: flex;
    flex-direction: row;
    align-items: center;
    padding: 0.5em;
    background: #f9fafb;
    width: 100%;
}

.turn-order-badge {
    font-size: 1.2em;
    font-weight: bold;
    width: 2em;
    height: 2em;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #3b82f6;
    color: white;
    border-radius: 50%;
    margin-right: 1em;
    box-shadow: 0 0.125em 0.25em rgba(0, 0, 0, 0.2);
}

.pb-player-name {
    font-weight: bold;
    font-size: 1.125em;
    margin-right: 1em;
}

.resource-display {
    display: flex;
    flex-direction: row;
    gap: 1em;
    align-items: center;
    flex-grow: 1;
}

.resource-item {
    display: flex;
    align-items: center;
    gap: 0.25em;
    font-size: 1em;
    font-weight: 600;
    color: #374151;
}

.resource-item.ml-auto {
    margin-left: auto;
}

/* Main Wrapper: Board | Conversions | Favors */
.pb-wrapper {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    width: 100%;
    gap: 1em;
    padding: 0.5em;
    overflow-x: auto;
}

/* Board Area: Vertical Stack (Upper: SH/SA/TP/Temples, Lower: Dwellings) */
.pb-board-area {
    display: flex;
    flex-direction: column;
    flex-wrap: nowrap;
    flex-grow: 1;
    gap: 1em;
    align-items: flex-start;
    /* Align everything to the left */
    padding: 0.5em;
    background-image: url('https://www.transparenttextures.com/patterns/aged-paper.png');
    background-color: #fffbeb;
    border: 1px solid #d1d5db;
    border-radius: 0.25em;
}

.pb-upper-section {
    display: flex;
    flex-direction: row;
    gap: 2em;
    width: 100%;
    justify-content: flex-start;
    /* Align to left */
}

.pb-lower-section {
    display: flex;
    flex-direction: row;
    width: 100%;
    justify-content: flex-start;
    /* Align to left */
}

.pb-dwellings-row {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 0.75em;
    /* Increased gap to match TP center-to-center spacing */
}

/* Panels: Vertical Stacks */
.pb-panel-left,
.pb-panel-right {
    display: flex;
    flex-direction: column;
    gap: 0.5em;
    align-items: flex-start;
}

/* Building Rows: Horizontal Stacks */
.pb-building-row {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    gap: 0.25em;
    align-items: center;
}

/* Slot Wrappers for Sizing */
.pb-slot-sh-sa {
    width: 3.5em;
    height: 3.5em;
    flex-shrink: 0;
}

.pb-slot-tp-temple {
    width: 2.5em;
    height: 2.5em;
    flex-shrink: 0;
}

.pb-slot-dwelling {
    width: 2em;
    height: 2em;
    flex-shrink: 0;
}

.building-slot {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    border: 1px solid #d1d5db;
    /* Bounding box border */
    background-color: rgba(255, 255, 255, 0.5);
    /* Light background */
    border-radius: 0.25em;
    overflow: hidden;
    /* Keep content inside */
}

.building-slot.built {
    border-color: #9ca3af;
    /* Darker border when built */
    background: transparent;
    /* Clear background when built (or keep consistent) */
}

.income-reveal {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75em;
    font-weight: bold;
    color: #4b5563;
    text-align: center;
    z-index: 0;
    /* Behind the piece */
    opacity: 0;
    /* Hidden by default */
    transition: opacity 0.3s ease-in-out;
}

/* Reveal income on hover after 2 seconds */
.building-slot:hover .income-reveal {
    opacity: 1;
    transition-delay: 2s;
}

/* Always reveal income for built slots (empty on board) */
.building-slot.built .income-reveal {
    opacity: 1;
    transition-delay: 0s;
}

.building-piece {
    width: 75%;
    height: 75%;
    /* filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.3)); REMOVED SHADOW */
    z-index: 1;
    /* On top of income */
    transition: opacity 0.3s ease-in-out;
    transition-delay: 0s;
    /* Reset delay normally */
}

/* Hover effect: Transparent after 2 seconds */
.building-slot:hover .building-piece {
    opacity: 0;
    transition-delay: 2s;
}

/* Conversions Column */
.pb-conversions-col {
    display: flex;
    flex-direction: column;
    gap: 0.5em;
    padding: 0.5em;
    border-left: 1px solid #d1d5db;
    min-width: 6.5em;
    flex-shrink: 0;
}

.pb-section-title {
    font-size: 0.875em;
    font-weight: bold;
    border-bottom: 1px solid #e5e7eb;
    padding-bottom: 0.25em;
    margin-bottom: 0.25em;
}

.conversion-area {
    display: flex;
    flex-direction: column;
    gap: 0.25em;
}

.conversion-btn {
    background: #3b82f6;
    color: white;
    border: none;
    border-radius: 0.25em;
    padding: 0.25em;
    font-size: 0.6em;
    cursor: pointer;
    transition: background 0.2s;
}

.conversion-btn:hover {
    background: #2563eb;
}

.conversion-btn.special {
    background-color: #9333ea;
}

.conversion-btn.special:hover {
    background-color: #7e22ce;
}

/* Favor Tiles Column */
.pb-favors-col {
    display: flex;
    flex-direction: column;
    gap: 0.5em;
    padding: 0.5em;
    border-left: 1px solid #d1d5db;
    min-width: 5.5em;
    flex-shrink: 0;
}

.pb-favors-list {
    display: flex;
    flex-direction: column;
    gap: 0.5em;
}

.pb-favor-tile {
    position: relative;
    width: 55%;
    aspect-ratio: 2 / 1;
    /* Match the 200x100 SVG viewBox */
    display: flex;
    align-items: center;
    justify-content: center;
    container-type: inline-size;
}

/* Replicating essential styles for PlayerBoard context to ensure they work correctly */
/* We scope them to .pb-favor-tile to avoid conflicts if global styles change */

.pb-favor-tile .favor-tile-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
}

.pb-favor-tile .favor-tile-content {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    padding: 0 5%;
    box-sizing: border-box;
}

.pb-favor-tile .favor-cult-steps {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.5cqw;
    width: 40%;
}

.pb-favor-tile .cult-step-circle {
    width: 10cqw;
    height: 10cqw;
    border-radius: 50%;
    border: 1px solid rgba(0, 0, 0, 0.3);
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.2);
}

.pb-favor-tile .favor-tile-content.justify-center {
    justify-content: center;
}

.pb-favor-tile .favor-cult-steps.w-full {
    width: 100%;
    flex-direction: row;
    gap: 2cqw;
}

.pb-favor-tile .favor-reward {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 60%;
    font-size: 15cqw;
    font-weight: bold;
    color: #333;
    text-align: center;
    line-height: 1;
}

.pb-favor-cult {
    font-weight: bold;
    color: white;
    width: 1.5em;
    height: 1.5em;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-size: 0.9em;
    flex-shrink: 0;
}

.pb-favor-reward {
    display: flex;
    align-items: center;
    gap: 0.25em;
    white-space: nowrap;
}

.bg-fire {
    background-color: #ef4444;
}

.bg-water {
    background-color: #3b82f6;
}

.bg-earth {
    background-color: #92400e;
}

.bg-air {
    background-color: #fbbf24;
    color: #78350f;
}

/* Darker text for yellow bg */

.pb-empty-text {
    font-size: 0.75em;
    color: #9ca3af;
    font-style: italic;
}

.pb-waiting {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 2em;
    color: #6b7280;
    font-style: italic;
}

/* Cost Indicators */
.cost-indicator {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 0.125em;
    margin-right: 0.5em;
    flex-shrink: 0;
    width: 2.5em;
    /* Fixed width for vertical alignment */
}

.cost-worker {
    width: 1.25em;
    height: 1.25em;
    background-color: white;
    border: 1px solid #5C4033;
    color: #5C4033;
    font-weight: bold;
    font-size: 0.75em;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0.0625em 0.125em rgba(0, 0, 0, 0.1);
}

.cost-coin {
    width: 1.25em;
    height: 1.25em;
    background-color: #FBBF24;
    border: 1px solid #D97706;
    border-radius: 50%;
    color: #5C4033;
    font-weight: bold;
    font-size: 0.75em;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0.0625em 0.125em rgba(0, 0, 0, 0.1);
}

.pb-power-bowl {
    display: flex;
    align-items: center;
    gap: 0.25em;
    font-size: 0.875em;
    font-weight: bold;
    line-height: 1.1;
}

/* Towns display in replay mode */
.pb-towns-area {
    display: flex;
    flex-direction: column;
    padding: 0.25em;
    min-height: 3em;
    max-width: 100%;
    overflow: hidden;
}

.pb-towns-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.35em;
    align-items: flex-start;
    max-width: 100%;
}

/* Town tile slot for player boards - matches town-tile-slot structure */
.pb-town-slot {
    position: relative;
    width: 40px;
    padding-top: 46px;
    /* 115% aspect ratio */
    display: flex;
    justify-content: center;
    align-items: center;
    container-type: inline-size;
    /* Enable container queries */
    flex-shrink: 0;
}

/* Override town-tile styles for pb context */
.pb-town-slot .town-tile {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}
